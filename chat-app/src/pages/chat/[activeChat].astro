---
import { actions } from "astro:actions";
import ChatDetailView from "@/components/chat-ui/chatDetailView";
import AuthedChatLayout from "@/layouts/AuthedChatLayout.astro";
import { getChat } from "@/actions/chats/getChat";

const { activeChat } = Astro.params;

if (!activeChat) {
	return Astro.redirect("/chat");
}

// Validate chat exists
const chatResult = await Astro.callAction(getChat, { chatId: activeChat });

if (!chatResult.data?.success) {
	return Astro.redirect("/chat");
}

const chatData = chatResult.data.message as any;
---

<AuthedChatLayout>
	<ChatDetailView client:load chatId={activeChat} />
</AuthedChatLayout>
